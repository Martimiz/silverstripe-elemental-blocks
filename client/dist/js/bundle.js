!function(e){function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=7)}([function(e,n,t){"use strict";function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function a(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"Component",function(){return b});var o=t(5),l=t.n(o),c=t(2),s=t.n(c),u=t(3),f=t.n(u),d=t(9),p=t.n(d),h=t(1),g=(t.n(h),t(10)),v=t.n(g),k=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),b=function(e){function n(e){i(this,n);var t=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.handleChangeValue=t.handleChangeValue.bind(t),t}return a(n,e),k(n,[{key:"componentDidMount",value:function(){var e=l()(f.a.findDOMNode(this)).find(".dropdown");e.chosen({allow_single_deselect:!0,disable_search_threshold:20}),e.change(function(){return p.a.Simulate.click(e.find(":selected")[0])})}},{key:"getOptionByValue",value:function(e){return this.props.actions.find(function(n){return n.value===e})}},{key:"handleChangeValue",value:function(e){var n=null,t=this.getOptionByValue(e.target.value);return null===t?null:(n="function"==typeof t.confirm?t.confirm().then(function(){return t.callback()}).catch(function(e){if("cancelled"!==e)throw e}):t.callback()||Promise.resolve(),l()(f.a.findDOMNode(this)).find(".dropdown").val("").trigger("liszt:updated"),n)}},{key:"render",value:function(){var e=this,n=this.props.actions.map(function(n){var t=v()("block-link-field__action","btn","btn-secondary",n.className||"");return s.a.createElement("button",{type:"button",className:t,key:n.value,onClick:e.handleChangeValue,value:n.value},n.label)}).filter(function(e){return e});if(!n.length)return null;var t=this.props.PopoverField;return s.a.createElement("div",{className:"block-link-field-actions fieldholder-small input-group"},s.a.createElement(t,{id:"BlockLinkFieldActions",popoverClassName:"block-link-field-actions__menu",data:{placement:"bottom"}},n))}}]),n}(c.Component);b.propTypes={actions:s.a.PropTypes.arrayOf(s.a.PropTypes.shape({value:s.a.PropTypes.string.isRequired,label:s.a.PropTypes.string.isRequired,className:s.a.PropTypes.string,destructive:s.a.PropTypes.bool,callback:s.a.PropTypes.func,canApply:s.a.PropTypes.func,confirm:s.a.PropTypes.func})),PopoverField:s.a.PropTypes.oneOfType([s.a.PropTypes.node,s.a.PropTypes.func])},b.defaultProps={actions:[],PopoverField:null},n.default=t.i(h.inject)(["PopoverField"],function(e){return{PopoverField:e}},function(){return"BlockLinkFieldActions"})(b)},function(e,n){e.exports=Injector},function(e,n){e.exports=React},function(e,n){e.exports=ReactDom},function(e,n){e.exports=i18n},function(e,n){e.exports=jQuery},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t(5),r=t.n(i),a=t(4),o=t.n(a),l=t(2),c=t.n(l),s=t(3),u=t.n(s),f=t(0),d=t(8),p=t(1),h=(t.n(p),Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}),g="insert-link__dialog-wrapper--internal",v=g+"-no-tinymce",k=t.i(p.provideInjector)(f.default);r.a.entwine("ss",function(e){e(".form__field-holder .blocklinkfield").entwine({getDialogWrapper:function(){return e("#"+g)},createDialog:function(){var n=this.getDialogWrapper();n.length||(n=e('<div id="'+g+'" />').addClass("insert-link__dialog-wrapper"),e("body").append(n))},onmatch:function(){this.createDialog()},onclick:function(n){if(!e(n.target).is("button")){var t=this.attr("name");this.getDialogWrapper().addClass(v).data("datafield-name",t).renderModal(!0),e("#"+g).updateModalTitle(e(this).find("#"+t+"_Title").val())}},registerChange:function(){this.find(".blocklinkfield__content").empty().append(e("<span/>").addClass("blocklinkfield__content--message").text(o.a._t("BlockLinkField.ModifiedMessage","Changes will be visible upon save")))}}),e(".js-injector-boot .blocklinkfield__actions").entwine({getLinkField:function(){return this.parent(".blocklinkfield")},getLinkDataField:function(){return this.getLinkField().find("input:hidden.blocklinkfield")},onmatch:function(){var e=JSON.parse(this.getLinkDataField().val());e&&void 0!==e.PageID&&this.renderActionsMenu()},renderActionsMenu:function(){var e=this,n=d.a.LINK_ACTIONS.map(function(n){if(!n.callback)switch(n.value){case"clear":return h({},n,{callback:function(){e.getLinkDataField().val("{}"),e.getLinkField().registerChange(),e.remove()}});default:return n}return n});u.a.render(c.a.createElement(k,{actions:n}),this[0])}}),e("#"+g).entwine({isTinyMce:function(){return!this.hasClass(v)},getLinkDataField:function(){var n=this.data("datafield-name");return e('input[name="'+n+'"]')},getDataFromLinkField:function(){var e=this.getLinkDataField(),n={};if(void 0!==e)try{n=JSON.parse(e.val())}catch(e){}return n||(n={}),n},setDataToLinkField:function(e){var n=this.getLinkDataField();if(n){var t={},i=Object.keys(e).filter(function(e){return["PageID","Anchor","Text","Description","TargetBlank"].includes(e)}).reduce(function(n,i){return t[i]=e[i],t},{});n.val(JSON.stringify(i))}},getModalTitle:function(){return e(".modal."+g).find(".modal-title")},updateModalTitle:function(e){this.getModalTitle().text(e)},getLinkAttributes:function(){var e=this.getDataFromLinkField();return{PageID:e.PageID||0,Anchor:e.Anchor||"",Text:e.Text||"",Description:e.Description||"",TargetBlank:e.TargetBlank||!1}},handleInsert:function(e){return this.isTinyMce()?this._super(e):(this.setDataToLinkField(e),this.close(),Promise.resolve())},getOriginalAttributes:function(){return this.isTinyMce()?this._super():this.getLinkAttributes()},updateFormField:function(){this.getLinkDataField().parent("div.blocklinkfield").registerChange()},close:function(){var e=this._super();return this.removeClass(v),this.updateFormField(),e}})})},function(e,n,t){t(6),t(0)},function(e,n,t){"use strict";var i=t(4),r=t.n(i);n.a={LINK_ACTIONS:[{value:"clear",label:r.a._t("BlockLinkField.ClearLink","Clear link"),className:"",destructive:!0,canApply:function(){return!0},callback:null}]}},function(e,n){e.exports=ReactAddonsTestUtils},function(e,n){e.exports=classnames}]);